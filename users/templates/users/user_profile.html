{% extends 'base.html' %}

{% block content %}
    <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-4">
            <div class="panel panel-default panel-profile">
                <div class="panel-body">
                    <div class="header"></div>
                    <img src="http://0.gravatar.com/avatar/088e4fb4456157398d147c276c22dabc?s=50&d=mm" alt=""/>
                    <strong>{{ user.name }}</strong>
                    <a href="{% url 'users:profile' pk=user.pk %}">@{{ user.username }}</a>
                    {% if user.description %}
                        <br/><br/>
                        <p>{{ user.description | escape }}</p>
                    {% endif %}
                    <a class="mdi-content-create pull-right"
                       style="color: rgba(0,0,0,0.84); text-decoration: none"
                       href="{% url 'users:edit' pk=user.pk %}"></a>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-md-8">

            {% if request.user.is_authenticated and request.user.pk == user.pk %}

                <form class="well" action="{% url 'posts:create' %}" method="post">
                {% csrf_token %}

                <br/>
                <textarea
                        maxlength="256"
                        name="content"
                        class="form-control floating-label {% if 'newPost' in form.errors %} has-error{% endif %}"
                        rows="3"
                        placeholder="newPost"></textarea>

                <button class="btn btn-lg btn-raised btn-material-light-blue" type="submit">newPost</button>

            </form>

            {% endif %}
            {% if posts %}
                {% for post in posts|dictsortreversed:'created_at' %}
                    <div class="well hover-here">
                        {% if post.original_post %}
                            <small>
                                <a href="{% url 'users:profile' pk=post.original_post.author.pk %}">
                                    @{{ post.original_post.author.username }}</a>
                                wrote on
                                <a href="{% url 'posts:post' pk=post.original_post.pk %}">
                                    {{ post.original_post.created_at }}</a>:
                            </small>
                        {% endif %}
                        <p>{{ post.content }}</p>
                        <small>
                            <a href="{% url 'users:profile' pk=post.author.pk %}">@{{ post.author.username }}</a>
                            {% if request.user.is_authenticated %}
                                {% if request.user.pk != post.author.pk and not post.original_post %}
                                    <a class="mdi-av-loop show-on-hover"
                                       style="text-decoration: none"
                                       href="{% url 'posts:repost' pk=post.pk %}"></a>
                                {% endif %}
                            {% endif %}
                            <a href="{% url 'posts:post' pk=post.pk %}" class="pull-right">{{ post.created_at }}</a>
                        </small>
                    </div>
                {% endfor %}
            {% else %}
                <p class="text-muted lead" style="color: #aaa; text-align: center;">This user has no Posts <br/>
                    #circuitzombie </p>
            {% endif %}
        </div>
    </div>
{% endblock %}
